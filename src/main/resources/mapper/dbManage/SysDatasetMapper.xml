<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.ciic.reporter.dbManage.mapper.SysDatasetMapper">
    <select id="queryDataSetList"  resultType="java.util.LinkedHashMap">
        SELECT s.`ds_name`,sds.`db_code`,s.`ds_type`,sd.`table_id`,sd.`field_id`,sd.`sort` FROM sys_dataset s LEFT JOIN
        sys_datasource sds ON s.`db_source_id`=sds.`id` LEFT JOIN sys_dataset_detail sd ON s.`ds_id`=sd.`id`
    </select>

    <select id="queryTreeList" resultType="java.util.LinkedHashMap">
        SELECT s.`ds_name` as label,s.id FROM sys_dataset s
    </select>

    <select id="queryDataByTreeKey" resultType="java.util.LinkedHashMap">
                        SELECT t1.id,
        t1.ds_name ,
        t2.field_name ,
        t3.db_name  ,
        t1.ds_type ,
        t2.table_id ,
        t2.field_id ,
        t2.sort
        FROM `sys_dataset` t1 join sys_dataset_detail t2 on t1.id=t2.ds_id
        join sys_datasource t3 on t1.db_source_id=t3.id where t1.id=#{id}
    </select>

</mapper>
